<dx:ThemedWindow x:Class="Dental.MainWindow" 
    Title="{Binding Path=Title}" Visibility="Visible" 
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core" 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:local="clr-namespace:Dental" 
    xmlns:viewModels="clr-namespace:Dental.ViewModels" 
    xmlns:services="clr-namespace:Dental.Services" 
    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon"
    mc:Ignorable="d" 
    d:DesignHeight="450" d:DesignWidth="800"      
    xmlns:conv ="clr-namespace:Dental.Infrastructures.Converters" 
    dx:ThemeManager.ThemeName="Office2019White"
    Closing="ThemedWindow_Closing"
    DataContext="{StaticResource Router}"
    Name="win">

    <dx:ThemedWindow.Resources>
        <conv:ImageConverter x:Key="ImageConverter" />
        <viewModels:MainWindowViewModel x:Key="mv"/>
    </dx:ThemedWindow.Resources>


    <Grid VerticalAlignment="Stretch" Margin="0,0,0,0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="10" />
        </Grid.RowDefinitions>

        <dxr:RibbonControl 
            AllowCustomization="False" 
            RibbonStyle="Office2019" 
            ShowApplicationButton="False" 
            Grid.Row="0" 
            Name="RibbonControl"
            >




            <dxr:RibbonControl.ToolbarItems>
                <dxb:BarButtonItem  
                    Content="Назад" Glyph="{dx:DXImage SvgImages/Arrows/Prev.svg}"
                    Command="{Binding GoToPreviousItem}"
                    CommandParameter="{Binding}"
                    IsEnabled="{Binding EnablePreviousBtn, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                <dxb:BarButtonItem   
                    Content="Вперед" Glyph="{dx:DXImage SvgImages/Arrows/Next.svg}"
                    Command="{Binding GoToNextItem}"
                    IsEnabled="{Binding EnableNextBtn, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <dxb:BarItemLinkSeparator/>
                <dxb:BarSplitButtonItem
                    x:Name="bar"
                    Content="История" 
                    Glyph="{dx:DXImage SvgImages/Business Objects/BO_Audit_ChangeHistory.svg}"
                    ActAsDropDown="True"
                    IsEnabled="{Binding EnableHistoryBtn, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    >
                        <dxb:BarSplitButtonItem.PopupControl>
                        <dxb:PopupControlContainer>
                            <dxe:ListBoxEdit SelectedItem="{Binding CurrentLink, UpdateSourceTrigger=PropertyChanged}" 
                                             ItemsSource="{Binding BrowsingHistory}" DisplayMember="Name">
                                <dxe:ListBoxEdit.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Margin="0" >
                                            <dxe:HyperlinkEdit 
                                                EditValue="{Binding Name}"
                                                ToolTip="{Binding Name}"
                                                Text="{Binding Name}"                                           
                                                Command="{Binding Source={StaticResource Router}, Path=GoToHistoryItem}"
                                                CommandParameter="{Binding}"
                                             
                                                   />
                                            <dxe:TextEdit Text="{Binding Time}" ShowBorder="False" />

                                            </StackPanel>

                                    </DataTemplate>
                                </dxe:ListBoxEdit.ItemTemplate>
                            </dxe:ListBoxEdit>
                        </dxb:PopupControlContainer>
                    </dxb:BarSplitButtonItem.PopupControl>
                
                </dxb:BarSplitButtonItem>
                <dxb:BarItemLinkSeparator/>
                <dxb:BarButtonItem 
                    Content="Справка" 
                    Glyph="{dx:DXImage SvgImages/Spreadsheet/Logical.svg}"
                    DataContext="{StaticResource mv}"
                    Command="{Binding OpenFormHelpCommand}"/>

                <dxb:BarButtonItem 
                    Content="Регистрация программы"
                    GlyphSize="Custom"
                    Glyph="pack://application:,,,/Resources/Icons/svg/reg1.svg"
                    GlyphAlignment="Bottom"
                    Margin="0 2 0 0"
                    AllowGlyphTheming="True"
                    CustomGlyphSize="13,13" 
                    DataContext="{StaticResource mv}"
                    Command="{Binding OpenFormRegCommand}"/>

                <dxb:BarButtonItem 
                    Content="О программе" 
                    Glyph="{dx:DXImage SvgImages/Icon Builder/Actions_Info.svg}"
                    DataContext="{StaticResource mv}"
                    Command="{Binding OpenFormAboutCommand}"/>

            </dxr:RibbonControl.ToolbarItems>


            <dxr:RibbonDefaultPageCategory>
                
                <dxr:RibbonPage Caption="Рабочий стол" >
                    <dxr:RibbonPageGroup Caption="Клиенты">
                        <dxb:BarButtonItem Content="Новый клиент" RibbonStyle="Default" 
                                           ToolTip="Новый клиент"
                                           Glyph="pack://application:,,,/Resources/Icons/Template/User-Add.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/User-Add.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/User-Add.png"                                        
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.PatientCard.MainInfoPage"/>

                        <dxb:BarButtonItem Content="Список клиентов" RibbonStyle="Default" 
                                           ToolTip="Список клиентов"
                                           Glyph="pack://application:,,,/Resources/Icons/Template/people.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/people.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/people.png"                                      
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.PatientCard.PatientsList"/>
                        <dxb:BarButtonItem Content="Список обращений" RibbonStyle="Default" 
                                           ToolTip="Список обращений"
                                           Glyph="pack://application:,,,/Resources/Icons/Template/User-Comment.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/User-Comment.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/User-Comment.png"                                        
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.ClientsRequests"/>


                    </dxr:RibbonPageGroup>
                    <dxr:RibbonPageGroup Caption="Основное">
                        <dxb:BarButtonItem Content="Расписание сотрудников" RibbonStyle="Default" 
                                           ToolTip="Расписание сотрудников"
                                           Glyph="pack://application:,,,/Resources/Icons/Template/Shedule.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/Shedule.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/Shedule.png"                                        
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.Sheduler"/>

                        <dxb:BarButtonItem Content="Рассылки" RibbonStyle="Default" 
                                           ToolTip="Рассылки"
                                           Glyph="pack://application:,,,/Resources/Icons/Template/Transmit-Blue.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/Transmit-Blue.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/Transmit-Blue.png"                                        
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.Subscribes.ClientsSubscribes"/>

                        <dxb:BarButtonItem Content="Сотрудники"
                                           RibbonStyle="Default" 
                                           Glyph="pack://application:,,,/Resources/Icons/Template/emp.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/emp.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/emp.png"   
                                           ToolTip="Сотрудники"
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.EmployeeDir.Employes"
                                           />


                        <dxb:BarButtonItem Content="Организация"
                                           RibbonStyle="Default" 
                                           Glyph="pack://application:,,,/Resources/Icons/Template/Draw-Clone.png" 
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/Draw-Clone.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/Draw-Clone.png"   
                                           ToolTip="Организация"
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.Organization"/>

                        <dxb:BarButtonItem Content="Услуги" 
                                           RibbonStyle="Default" 
                                           Glyph="pack://application:,,,/Resources/Icons/Template/Chart-Organisation.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/Chart-Organisation.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/Chart-Organisation.png"   
                                            ToolTip="Услуги"
                                            Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.Classificator"/>
                        
                    </dxr:RibbonPageGroup>

                    
                </dxr:RibbonPage>
                <dxr:RibbonPage Caption="Статистика" >
                    <dxr:RibbonPageGroup Caption="Сводные таблицы" >
                        <dxb:BarButtonItem Content="Сводные данные по сотрудникам" RibbonStyle="Default" 
                                           ToolTip="Сводные данные по сотрудникам"
                                           Glyph="pack://application:,,,/Resources/Icons/Template/Sallary-Deferrais.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/Sallary-Deferrais.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/Sallary-Deferrais.png"                                        
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.Reports.EmployeeSummary"/>

                        <dxb:BarButtonItem Content="Планы услуг и продажи" RibbonStyle="Default" 
                                           ToolTip="Планы услуг и продажи"
                                           Glyph="pack://application:,,,/Resources/Icons/Template/Finance.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/Finance.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/Finance.png"                                        
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.Reports.AllPlans"/>
                    </dxr:RibbonPageGroup>
                    <dxr:RibbonPageGroup Caption="Отчеты" >
                        <dxb:BarButtonItem Content="Выручка по сотрудникам" RibbonStyle="Default" 
                                           ToolTip="Выручка по сотрудникам"
                                           Glyph="pack://application:,,,/Resources/Icons/Template/Chart-Pie.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/Chart-Pie.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/Chart-Pie.png"                                    
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.Reports.ByEmployes"/>
                        
                        <dxb:BarButtonItem Content="Выручка за периоды" RibbonStyle="Default" 
                                           ToolTip="Статистика по выручке по заданным периодам"
                                           Glyph="pack://application:,,,/Resources/Icons/Template/Chart-Curve.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/Chart-Curve.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/Chart-Curve.png"                                    
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.Reports.ByPeriods"/>
                        
                        <dxb:BarButtonItem Content="Приемы пациентов" RibbonStyle="Default" 
                                           ToolTip="Статистика по приему пациентов"
                                           Glyph="pack://application:,,,/Resources/Icons/Template/Chart-Bar.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/Chart-Bar.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/Chart-Bar.png"                                    
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.Reports.ByVisits"/>
                        
                        <dxb:BarButtonItem Content="Выручка по услугам" RibbonStyle="Default" 
                                           ToolTip="Выручка по услугам"
                                           Glyph="pack://application:,,,/Resources/Icons/Template/Table.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/Table.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/Table.png"                                    
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.Reports.ByServices"/>
                        
                        <dxb:BarButtonItem Content="Каналы привлечения" RibbonStyle="Default" 
                                           ToolTip="Статистика по каналам привлечения"
                                           Glyph="pack://application:,,,/Resources/Icons/Template/Columnchart.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/Columnchart.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/Columnchart.png"                                    
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.Reports.ByAdvertising"/>

                    </dxr:RibbonPageGroup>
                    <dxr:RibbonPageGroup Caption="История" >
                        <dxb:BarButtonItem Content="Действия пользователя" RibbonStyle="Default" 
                                           ToolTip="Действия пользователя"
                                           Glyph="pack://application:,,,/Resources/Icons/Template/Columnchart.png"
                                           MediumGlyph="pack://application:,,,/Resources/Icons/Template/Columnchart.png" 
                                           LargeGlyph="pack://application:,,,/Resources/Icons/Template/Columnchart.png"                                    
                                           Command="{Binding LeftMenuClick}" CommandParameter="Dental.Views.UserActions"/>
                    </dxr:RibbonPageGroup>
                </dxr:RibbonPage>

            </dxr:RibbonDefaultPageCategory>
            
        </dxr:RibbonControl>


        <Frame  
           Name="FramePage" VerticalAlignment="Stretch" 
           Grid.Row="1" Grid.Column="1" 
           HorizontalAlignment="Stretch" 
           NavigationUIVisibility="Hidden" 
           Content="{Binding CurrentPage}" 
           Opacity="{Binding FrameOpacity}" />
    </Grid>
</dx:ThemedWindow>