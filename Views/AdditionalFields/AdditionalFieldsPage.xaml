<Page x:Class="Dental.Views.AdditionalFields.AdditionalFieldsPage"
       xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
       xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
       xmlns:dxi="http://schemas.devexpress.com/winfx/2008/xaml/core/internal"
       xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
       xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
       xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
       xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
       xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
       xmlns:extens ="clr-namespace:Dental.Infrastructures.Extensions"
       xmlns:sys="clr-namespace:System;assembly=mscorlib"
       xmlns:converter="clr-namespace:Dental.Infrastructures.Converters" 
       xmlns:commands ="clr-namespace:Dental.Infrastructures.Commands"
       xmlns:services="clr-namespace:Dental.Services"
       mc:Ignorable="d"
       d:DesignHeight="400"
       dx:ThemeManager.ThemeName="Office2019White"
       xmlns:vm ="clr-namespace:Dental.ViewModels.AdditionalFields" 
       xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
       d:DesignWidth="800"
       Title="Дополнительные поля" >
    <Page.Resources>
        <vm:AdditionalFieldsViewModel x:Key="vm"/>
    </Page.Resources>

    <Border
        DataContext="{StaticResource vm}"
        BorderBrush="LightGray" 
        BorderThickness="1" 
        Margin="5" 
        dx:ThemeManager.ThemeName="Office2019White">

        <Grid x:Name="gridMain" >
            <Grid.RowDefinitions>
                <RowDefinition Height="24"/>
                <RowDefinition Height="2"/>
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <DockPanel LastChildFill="True" Grid.Row="0">
                <StackPanel DockPanel.Dock="Left" HorizontalAlignment="Left" Orientation="Horizontal">
                    <dx:DXImage Height="20" Width="20" Margin="5 0 0 0"
                                Source="{dx:DXImage SvgImages/RichEdit/ListBullets.svg}"/>
                    <TextBlock Text="Дополнительные поля" FontSize="14" Padding="2 5 5 0" />
                </StackPanel>
                <dxb:BarContainerControl DockPanel.Dock="Top" HorizontalAlignment="Right">

                    <dxb:ToolBarControl x:Name="fileToolBar" ShowDragWidget="False" Caption="File" 
                                        AllowCustomizationMenu="False" AllowQuickCustomization="False" BarItemDisplayMode="ContentAndGlyph">
                        <dxb:BarButtonItem Content="Добавить поле" Margin="0 0 5 0"                                         
                                           GlyphSize="Small"
                                           Command="{Binding OpenFieldFormCommand}"
                                           Glyph="{dx:DXImage SvgImages/Icon Builder/Actions_Add.svg}"/>
                        
                        <dxb:BarButtonItem Content="Добавить категорию"                                        
                                           GlyphSize="Small"
                                           Command="{Binding OpenCategoryFormCommand}"
                                           Glyph="{dx:DXImage SvgImages/Icon Builder/Actions_FolderClose.svg}"/>
                    </dxb:ToolBarControl>
                </dxb:BarContainerControl>
            </DockPanel>


            <dxg:GridControl
                ShowBorder="True"
                Grid.Row="2" 
                Name="grid"                             
                ItemsSource="{Binding Collection1}"               
                Margin="2 0 2 2"
                DefaultSorting="LastName"
                >

                <dxg:GridControl.View>
                    <dxg:CardView 
                        ShowColumnHeaders="False"
                        AllowSorting="True"
                        Name="view"
                        NavigationStyle="Row"
                        EditorButtonShowMode="ShowAlways"
                        ShowGroupPanel="False"                       
                        ShowGroupedColumns="True"            
                        PrintMaximumCardColumns="2"
                        PrintAutoCardWidth="True"
                        UseLegacyFilterPanel="False" AllowEditing="False" CardLayout="Columns">


                        <dxg:CardView.InputBindings>
                            <KeyBinding 
                                Key="E" 
                                Modifiers="Ctrl" 
                                Command="{Binding Source={StaticResource vm}, Path=NavigateToCommand}"
                                CommandParameter="-1"/>

                            <KeyBinding 
                                Key="O"     
                                Modifiers="Ctrl"
                                Command="{Binding Source={StaticResource vm}, Path=NavigateToCommand}"
                                CommandParameter="{Binding ElementName=view, Path=FocusedRow.Id}"  />

                            <MouseBinding 
                                Gesture="LeftDoubleClick"      
                                Command="{Binding Source={StaticResource vm}, Path=NavigateToCommand}"
                                CommandParameter="{Binding ElementName=view, Path=FocusedRow.Id}"/>

                        </dxg:CardView.InputBindings>

                    </dxg:CardView>
                </dxg:GridControl.View>

            </dxg:GridControl>
        </Grid>
    </Border>

</Page>